tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
class(assign_data$sex)
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(haven)
library(tidyr)
library(dplyr)
library(gtsummary)
library(vtable)
library(MatchIt)
library(modelsummary)
library(ggplot2)
here()
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
assign_data$sex <- as.factor(assign_data$sex) # Convert sex from a character to a factor
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q.1_tbl <- tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q.1_tbl <- tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q.1_tbl
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
assign_data$sex[assign_data$sex == "1"] <- 0
assign_data$sex[assign_data$sex == "2"] <- 1
assign_data$sex <- as.factor(assign_data$sex) # Convert sex from a character to a factor
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
class(assign_data$policyholder)
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
assign_data$sex[assign_data$sex == "1"] <- 0
assign_data$sex[assign_data$sex == "2"] <- 1
#assign_data$sex <- as.factor(assign_data$sex) # Convert sex from a character to a factor
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
View(assign_data)
summary(assign_data$policyholder)
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "dichotomous"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
tbl_summary(data = assign_data, by = "hdhp",
type = list(sex ~ "categorical"),
statistic = list(all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("sex")) %>%
add_p(test = everything() ~ "t.test")
class(assign_data$sex)
assign_data$sex[assign_data$sex == "1"] <- 0
assign_data$sex[assign_data$sex == "2"] <- 1
class(assign_data$sex)
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
assign_data$sex[assign_data$sex == "1"] <- 0
assign_data$sex[assign_data$sex == "2"] <- 1
class(assign_data$sex)
assign_data$sex <- as.factor(assign_data$sex) # Convert sex from a character to a factor
class(assign_data$sex)
assign_data$sex <- as.numeric(assign_data$sex) # Convert sex from a character to a factor
class(assign_data$sex)
tbl_summary(data = assign_data, by = "hdhp",
type = list(sex ~ "categorical"),
statistic = list(all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("sex")) %>%
add_p(test = everything() ~ "t.test")
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{mean} ({sd})"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(haven)
library(tidyr)
library(dplyr)
library(gtsummary)
library(vtable)
library(MatchIt)
library(modelsummary)
library(ggplot2)
here()
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
oneb_reg_naive <- lm(pay ~ hdhp + age + sex + famsize + policyholder +
num_hospitalizations + num_chronicconditions + num_scrips,
data = assign_data)
msummary(oneb_reg_naive)
one_b_reg_naive <- lm(pay ~ hdhp + age + sex + famsize + policyholder +
num_hospitalizations + num_chronicconditions + num_scrips,
data = assign_data)
msummary(one_b_reg_naive)
View(oneb_reg_naive)
one_b_reg_naive
?msummary
View(assign_data)
View(assign_data)
one_b_reg_naive <- lm(pay ~ hdhp + age + sex + famsize + policyholder +
num_hospitalizations + num_chronicconditions + num_scrips,
data = assign_data)
one_b_reg_naive
msummary(one_b_reg_naive)
one_b_reg_naive
msummary(one_b_reg_naive)
one_b_reg_naive
msummary(one_b_reg_naive)
one_b_reg_naive
?add_p
model_view <- lm(pay~sex, data = assign_data)
model_view_1 <- lm(pay~sex, data = assign_data)
model_view_2 <- lm(pay~famsize, data = assign_data)
model_view_3 <- lm(pay~num_scrips, data = assign_data)
windows()
plot(assign_data$sex, assign_data$pay)
abline(coef(model_view_1), col="gray")
one_b_reg_naive
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(haven)
library(tidyr)
library(dplyr)
library(gtsummary)
library(vtable)
library(MatchIt)
library(modelsummary)
library(ggplot2)
here()
assign_data <- read_dta("/Users/husaynjessa/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
assign_data %>%
summarise_all(funs(sum(is.na(.)))) # Returns no NAs, can probably remove
assign_data$sex <- as.factor(assign_data$sex) # Convert sex from a character to a factor
assign_data$sex <- as.numeric(assign_data$sex) # Convert sex from a character to a numeric
tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
question1d_match <- matchit(hdhp ~ num_hospitalizations + age + sex + famsize + policyholder +
num_hospitalizations + num_chronicconditions + num_scrips,
data = assign_data,
method = "nearest",
replace = TRUE,
distance = "scaled_euclidean")
summary(question1d_match)
qd_match_data <-  match.data(question1d_match)
matched_balance_table <- tbl_summary(data = question1d_match, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(haven)
library(tidyr)
library(dplyr)
library(gtsummary)
library(vtable)
library(MatchIt)
library(modelsummary)
library(ggplot2)
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
question1e_match <- matchit(hdhp ~ num_hospitalizations + age + sex + famsize + policyholder +
num_hospitalizations + num_chronicconditions + num_scrips,
data = assign_data,
method = "nearest",
distance='glm', # generalized linear model for propensity,
replace = TRUE
)
qe_psmmatch_data <- match.data(question1e_match)
write.csv(qe_psmmatch_data, "/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Question_1e_matched_data.csv")
ggplot(qe_psmmatch_data,aes(x=distance, fill = factor(pay))) +
geom_histogram(binwidth = .05,color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Count",fill="pay")
ggplot(qe_psmmatch_data,aes(x=distance, fill = factor(pay)))
ggplot(qe_psmmatch_data,aes(x=distance, fill = factor(pay))) +
geom_histogram(binwidth = .05,color='black')
ggplot(qe_psmmatch_data,aes(x=distance, fill = factor(pay))) +
#geom_histogram(binwidth = .05,color='black') +
theme_minimal()
ggplot(qe_psmmatch_data,aes(x=distance, fill = factor(pay))) +
#geom_histogram(binwidth = .05,color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Count",fill="pay")
geom_histogram(binwidth = .05,color='black')
hist(qe_psmmatch_data$distance)
ggplot(qe_psmmatch_data,aes(x=distance, fill = pay))
View(qe_psmmatch_data)
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(binwidth = .05,color='black')
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(binwidth = .05,color='black') +
theme_minimal()
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(binwidth = .05,color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Count",fill="pay")
qe_psmmatch_data$sex <- as.factor(qe_psmmatch_data$sex) # Convert sex from a character to a factor
qe_psmmatch_data$sex <- as.numeric(qe_psmmatch_data$sex) # Convert sex from a character to a numeric
q_e_matched_balance_table <- tbl_summary(data = qe_psmmatch_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q_e_matched_balance_table
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(binwidth = .05,color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Count",fill="pay")
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(haven)
library(tidyr)
library(dplyr)
library(gtsummary)
library(vtable)
library(MatchIt)
library(modelsummary)
library(ggplot2)
assign_data <- read_dta("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Dataset2a_Claims (1).dta")
write.csv(qe_psmmatch_data, "/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Question_1e_matched_data.csv")
qe_psmmatch_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Question_1e_matched_data.csv")
qe_psmmatch_data$sex <- as.factor(qe_psmmatch_data$sex) # Convert sex from a character to a factor
qe_psmmatch_data$sex <- as.numeric(qe_psmmatch_data$sex) # Convert sex from a character to a numeric
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(binwidth = .05,color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Count",fill="pay")
View(qe_psmmatch_data)
hist(qe_psmmatch_data$distance) # Look at overall distribution of propensity scores
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Count",fill="pay")
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Density",fill="pay")
View(assign_data)
ggplot(qe_psmmatch_data, aes(x=distance)) +
geom_histogram(color='black') +
theme_minimal()
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(color='black') +
theme_minimal()
ggplot(qe_psmmatch_data, aes(x=distance, fill = pay)) +
geom_histogram(color='black') +
theme_minimal() +
labs(x="Propensity Score", y="Density",fill="pay")
question1e_match <- matchit(hdhp ~ num_hospitalizations + age + sex + famsize + policyholder +
num_hospitalizations + num_chronicconditions + num_scrips,
data = assign_data,
method = "nearest",
distance='glm', # generalized linear model for propensity,
replace = TRUE
)
summary(question1e_match)
q_e_matched_balance_table
q_e_matched_balance_table <- tbl_summary(data = qe_psmmatch_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q_e_matched_balance_table <- tbl_summary(data = qe_psmmatch_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q_e_matched_balance_table
?sumtable
assign_data$sex <- as.factor(assign_data$sex) # Convert sex from a character to a factor
assign_data$sex <- as.numeric(assign_data$sex) # Convert sex from a character to a numeric
unmatched_table <- tbl_summary(data = assign_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q_d_matched_table <- tbl_summary(data = q_d_match_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
write.csv(qe_psmmatch_data, "/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Question_1e_matched_data.csv")
qe_psmmatch_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744/Assignment 2/Question_1e_matched_data.csv")
qe_psmmatch_data$sex <- as.factor(qe_psmmatch_data$sex) # Convert sex from a character to a factor
qe_psmmatch_data$sex <- as.numeric(qe_psmmatch_data$sex) # Convert sex from a character to a numeric
q_e_matched_balance_table <- tbl_summary(data = qe_psmmatch_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
q_e_matched_table <- tbl_summary(data = qe_psmmatch_data, by = "hdhp",
type = list(age ~ "continuous",
famsize ~ "continuous",
policyholder ~ "categorical",
num_hospitalizations ~ "continuous",
num_chronicconditions ~ "continuous",
num_scrips ~ "continuous",
sex ~ "categorical"),
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"),
digits = everything() ~ 2,
include = c("age", "sex", "famsize", "policyholder",
"num_hospitalizations", "num_chronicconditions", "num_scrips")) %>%
add_p(test = everything() ~ "t.test")
tbl_merge(q_e_matched_table, unmatched_table)
tbl_merge(tbls = list(q_e_matched_table, unmatched_table))
